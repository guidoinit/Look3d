/*!CK:2456248679!*//*1383165947,178191153*/

if (self.CavalryLogger) { CavalryLogger.start_js(["jSAkD"]); }

__d("SubscriptionLevels",[],function(a,b,c,d,e,f){var g={ALL:'162318810514679',DEFAULT:'271670892858696',TOP:'266156873403755'};e.exports=g;});
__d("EditSubscriptions",["Event","function-extensions","Arbiter","AsyncRequest","CSS","DOM","MenuDeprecated","Parent","SubscriptionLevels","FeedBlacklistButton","arrayContains","cx","ge"],function(a,b,c,d,e,f){var g=b('Event');b('function-extensions');var h=b('Arbiter'),i=b('AsyncRequest'),j=b('CSS'),k=b('DOM'),l=b('MenuDeprecated'),m=b('Parent'),n=b('SubscriptionLevels'),o=b('FeedBlacklistButton'),p=b('arrayContains'),q=b('cx'),r=b('ge'),s=45,t=[n.ALL,n.DEFAULT,n.TOP],u={},v={},w={},x={},y={},z={},aa={},ba={},ca={},da={},ea={},fa="/ajax/follow/follow_profile.php",ga="/ajax/follow/unfollow_profile.php",ha="/ajax/settings/notifications/notify_me.php",ia={},ja={},ka=null,la=false,ma={};function na(kb){return p(t,kb);}function oa(kb,lb,mb,nb){var ob=m.byClass(nb,'uiMenuItem')||m.byClass(nb,"_54ni"),pb=k.getID(kb);if(!ob||!k.contains(kb,ob)){return;}else if(j.hasClass(ob,'SubscribeMenuSubscribeCheckbox')){if(w[lb]){sa(pb,lb);}else ra(pb,lb);return false;}else if(j.hasClass(ob,'SubscribeMenuUnsubscribe')){sa(pb,lb);return false;}else if(j.hasClass(ob,'SubscribeMenuSettingsItem')){eb(kb,true);return false;}else if(j.hasClass(ob,'SubscriptionMenuGoBack')){eb(kb,false);return false;}else if(j.hasClass(ob,'SubscriptionMenuItem')){pa(kb,lb,mb,ob);return false;}else if(j.hasClass(ob,'SubscribeMenuNotifyMeCheckbox')){if(x[lb]){ib(kb,lb);}else hb(kb,lb);return false;}}function pa(kb,lb,mb,nb){if(j.hasClass(nb,'SubscriptionMenuLevel')){if(l.isItemChecked(nb))return;cb(kb,lb,va(nb),true,mb);}else if(j.hasClass(nb,'SubscriptionMenuCategory')){za(lb,nb,!l.isItemChecked(nb),true,mb);}else if(j.hasClass(nb,'SubscriptionAppStory'))bb(lb,nb,!l.isItemChecked(nb),mb);}function qa(kb){return ma[kb]?ma[kb]:0;}function ra(kb,lb){var mb={profile_id:lb};h.inform('FollowingUser',mb);h.inform(o.UNBLACKLIST,mb);new i().setURI(fa).setMethod('POST').setData({profile_id:lb,location:qa(kb)}).setErrorHandler(h.inform.curry('FollowUserFail',mb)).send();}function sa(kb,lb){var mb={profile_id:lb};h.inform('UnfollowingUser',mb);h.inform(o.BLACKLIST,mb);new i().setURI(ga).setMethod('POST').setData({profile_id:lb,location:qa(kb)}).setErrorHandler(h.inform.curry('UnfollowUserFail',mb)).send();}function ta(kb,lb,mb){var nb={profile_id:kb,level:ba[kb],custom_categories:ca[kb],location:mb};new i().setURI('/ajax/follow/manage_subscriptions.php').setData(nb).send();}function ua(kb,lb){var mb=ca[lb]||[],nb=l.getItems(kb);nb.forEach(function(ob){if(j.hasClass(ob,'SubscriptionMenuCategory')){var pb=va(ob);if(p(mb,pb)){xa(ob);}else ya(ob);}else if(j.hasClass(ob,'SubscriptionAppStory')){var qb=va(ob);if(ja[lb]&&ja[lb][qb]){xa(ob);}else ya(ob);}});cb(kb,lb,ba[lb],false);}function va(kb){var lb=k.scry(kb,'input')[0];return lb&&lb.value;}function wa(kb){return k.find(kb,'a.itemAnchor');}function xa(kb){j.addClass(kb,'checked');wa(kb).setAttribute('aria-checked',true);}function ya(kb){j.removeClass(kb,'checked');wa(kb).setAttribute('aria-checked',false);}function za(kb,lb,mb,nb,ob){if(mb){xa(lb);}else ya(lb);var pb=va(lb);if(na(pb)){mb&&ab(kb,pb);}else if(mb){if(!p(ca[kb],pb))ca[kb].push(pb);}else{var qb=ca[kb].indexOf(pb);if(qb!==-1)ca[kb].splice(qb,1);}if(nb)ta(kb,pb,ob);}function ab(kb,lb){ba[kb]=lb;h.inform('SubscriptionLevelUpdated',{profile_id:kb,level:lb});}function bb(kb,lb,mb,nb){var ob='/ajax/feed/filter_action/',pb=va(lb),qb={actor_id:kb,app_id:pb};if(mb){xa(lb);ob+='resubscribe_user_app/';qb.action='resubscribe_user_app';if(!ja[kb])ja[kb]={};ja[kb][pb]=true;}else{ya(lb);ob+='unsubscribe_user_app_checkbox/';qb.action='unsubscribe_user_app_checkbox';if(ja[kb])ja[kb][pb]=false;}new i().setURI(ob).setData(qb).send();}function cb(kb,lb,mb,nb,ob){var pb=k.scry(kb,'.SubscriptionMenuLevel'),qb=null;pb.forEach(function(rb){if(va(rb)==mb){qb=rb;}else if(l.isItemChecked(rb))za(lb,rb,false,false);});qb&&za(lb,qb,true,nb,ob);}function db(kb,lb,mb){w[lb]=mb;j.conditionClass(kb,'isUnsubscribed',!mb);var nb=k.scry(kb,'li.SubscribeMenuSubscribeCheckbox');if(nb.length!==0){var ob=nb[0];if(mb){xa(ob);}else ya(ob);}}function eb(kb,lb){j.conditionClass(kb,'subscriptionMenuOpen',lb);}function fb(kb,lb,mb){var nb=k.find(kb,".FriendListSubscriptionsMenu"),ob=k.find(nb,".uiMenuInner");if(ka!=null)ka.forEach(function(pb){ob.removeChild(pb);});mb.forEach(function(pb){ob.appendChild(pb);});ka=mb;}h.subscribe('UnfollowUser',function(kb,lb){if(da[lb.profile_id]){ab(lb.profile_id,da[lb.profile_id]);ca[lb.profile_id]=ea[lb.profile_id].slice();}});h.subscribe('UpdateSubscriptionLevel',function(kb,lb){var mb=lb.profile_id+'',nb=lb.level+'';ab(mb,nb);var ob;for(ob in u)if(u[ob]===mb){var pb=r(ob);pb&&cb(pb,mb,nb,false);}});function gb(kb,lb,mb){x[lb]=mb;var nb=z[lb]&&!la,ob=k.scry(kb,'li.SubscribeMenuNotifyMeCheckbox');if(ob.length!==0){var pb=ob[0];j.conditionShow(pb,!nb);var qb=k.scry(kb,'li.SubscribeMenuNotifyMeCheckboxSeparator');if(qb.length>0)j.conditionShow(qb[0],!nb);if(mb){xa(pb);}else ya(pb);}}function hb(kb,lb){var mb={profile_id:lb};h.inform('EnableNotifsForUser',mb);new i().setURI(ha).setMethod('POST').setData({notifier_id:lb,enable:true}).setErrorHandler(h.inform.curry('EnableNotifsForUserFail',mb)).send();}function ib(kb,lb){var mb={profile_id:lb};h.inform('DisableNotifsForUser',mb);new i().setURI(ha).setMethod('POST').setData({notifier_id:lb,enable:false}).setErrorHandler(h.inform.curry('DisableNotifsForUserFail',mb)).send();}var jb={init:function(kb,lb,mb){var nb=k.getID(kb);ma[nb]=mb;if(!u[nb])g.listen(kb,'click',function(ob){return oa(kb,u[nb],mb,ob.getTarget());});if(mb===s&&ia[lb].length)fb(kb,lb,ia[lb]);if(ba[lb])ua(kb,lb);u[nb]=lb;j.conditionClass(kb,'NonFriendSubscriptionMenu',!v[lb]);j.conditionClass(kb,'cannotSubscribe',!y[lb]);j.conditionClass(kb,'noSubscriptionLevels',z[lb]&&!aa[lb]);j.conditionClass(kb,'noSubscribeCheckbox',!v[lb]&&!z[lb]);db(kb,lb,w[lb]);gb(kb,lb,x[lb]);h.subscribe(['FollowUser','FollowingUser','UnfollowUserFail'],function(ob,pb){if(pb.profile_id==lb)db(kb,lb,true);}.bind(this));h.subscribe(['UnfollowUser','UnfollowingUser','FollowUserFail'],function(ob,pb){if(pb.profile_id==lb){h.inform('SubMenu/Reset');db(kb,lb,false);}}.bind(this));h.subscribe(['EnableNotifsForUser','DisableNotifsForUserFail'],function(ob,pb){gb(kb,lb,true);}.bind(this));h.subscribe(['DisableNotifsForUser','EnableNotifsForUserFail'],function(ob,pb){gb(kb,lb,false);}.bind(this));h.subscribe('listeditor/friend_lists_changed',function(ob,pb){if(pb.notify_state){var qb=pb.added_uid?pb.added_uid:pb.removed_uid;gb(kb,qb,pb.notify_state.is_notified);}}.bind(this));},getSubscriptions:function(kb){return {level:ba[kb],custom_categories:ca[kb]};},setSubscriptions:function(kb,lb,mb,nb,ob,pb,qb,rb,sb,tb,ub,vb,wb){ab(kb,qb+'');v[kb]=lb;w[kb]=mb;y[kb]=nb;z[kb]=ob;aa[kb]=pb;da[kb]=sb+'';ca[kb]=rb.map(String);ea[kb]=tb.map(String);ia[kb]=wb;x[kb]=ub;la=vb;}};e.exports=a.EditSubscriptions||jb;});
__d("legacy:EditSubscriptions",["SubscriptionLevels","EditSubscriptions"],function(a,b,c,d){a.SubscriptionLevels=b('SubscriptionLevels');a.EditSubscriptions=b('EditSubscriptions');},3);
__d("DynamicFriendListEducation",["Event","Arbiter","AsyncRequest","Dialog","PageTransitions","arrayContains","createArrayFrom","removeFromArray"],function(a,b,c,d,e,f){var g=b('Event'),h=b('Arbiter'),i=b('AsyncRequest'),j=b('Dialog'),k=b('PageTransitions'),l=b('arrayContains'),m=b('createArrayFrom'),n=b('removeFromArray'),o,p,q,r,s,t;function u(){q&&q.hide();r&&r.hide();}function v(y){n(p,y);u();s({accept_tag_education:true});}function w(){u();s({nux_cancel:true});}var x={init:function(y,z){o=y;p=m(z).map(String);k.registerHandler(function(){u();o=false;s=undefined;p=[];});},showDialog:function(y,z,aa){if(o&&l(p,y)){u();h.inform('DynamicFriendListEducation/dialogOpen',{uid:z,flid:y});s=aa;q=new j().setAsync(new i('/ajax/friends/lists/smart_list_education.php').setMethod('GET').setData({flid:y,uid:z}).setReadOnly(true)).setHandler(v.bind(this,y)).setCloseHandler(function(){h.inform('DynamicFriendListEducation/dialogClosed',{uid:z,flid:y});}).setCancelHandler(function(){h.inform('DynamicFriendListEducation/dialogCancel',{uid:z,flid:y});}).show();}else aa();},showContextualDialog:function(y,z,aa,ba){if(o&&l(p,y)){u();t=aa;s=ba;new i('/ajax/friends/lists/smart_list_contextual_education.php').setMethod('GET').setData({flid:y,uid:z}).setReadOnly(true).send();}else ba();},setContextualDialog:function(y,z,aa,ba){r=y;r.setContext(t);r.show();g.listen(z,'click',v.bind(this,ba));g.listen(aa,'click',w);}};e.exports=x;});
__d("FriendStatus",["function-extensions","Arbiter","AsyncRequest","SubscribeButton","arrayContains","copyProperties","createArrayFrom","eachKeyVal"],function(a,b,c,d,e,f){b('function-extensions');var g=b('Arbiter'),h=b('AsyncRequest'),i=b('SubscribeButton'),j=b('arrayContains'),k=b('copyProperties'),l=b('createArrayFrom'),m=b('eachKeyVal');function n(r,s,t){this.id=r;this.update(s,t);}k(n.prototype,{update:function(r,s){r&&(this.status=r);if(s){this.lists=l(s).map(String);this._informListChange();}},isComplete:function(){return !!this.lists;},addToList:function(r){if(this.lists&&!j(this.lists,r))this.lists.push(r);this._informListChange();},removeFromList:function(r){if(this.lists){var s=this.lists.indexOf(r);s!==-1&&this.lists.splice(s,1);}this._informListChange();},updateList:function(r,s){s?this.addToList(r):this.removeFromList(r);},_informListChange:function(){g.inform('FriendListMembershipChange',{uid:this.id,lists:this.lists});}});k(n,{ARE_FRIENDS:1,INCOMING_REQUEST:2,OUTGOING_REQUEST:3,CAN_REQUEST:4});var o={},p={};function q(r,s,t){if(!o[t.uid]){o[t.uid]=new n(t.uid,r);}else o[t.uid].update(r);g.inform('FriendRequest/change',{uid:t.uid,status:r});}g.subscribe(['FriendRequest/cancel','FriendRequest/unfriend'],function(r,s){s.profile_id=s.uid;s.check_enabled_follow=true;g.inform(i.UNSUBSCRIBED,s);});g.subscribe(['FriendRequest/cancel','FriendRequest/unfriend','FriendRequest/sendFail'],q.curry(n.CAN_REQUEST));g.subscribe(['FriendRequest/confirmFail'],q.curry(n.INCOMING_REQUEST));g.subscribe(['FriendRequest/cancelFail','FriendRequest/sent','FriendRequest/sending'],q.curry(n.OUTGOING_REQUEST));g.subscribe(['FriendRequest/confirm','FriendRequest/confirming'],q.curry(n.ARE_FRIENDS));k(n,{CLOSE_FRIENDS:null,ACQUAINTANCES:null,getFriend:function(r,s){if(o[r]&&o[r].isComplete()){s(o[r]);}else if(p[r]){p[r].push(s);}else{p[r]=[s];new h().setURI("/ajax/friends/status.php").setData({friend:r}).setHandler(function(t){var u=t.getPayload();n.initFriend.bind(n,r,u.status,u.lists).defer();}).send();}},initFriend:function(r,s,t){var u=o[r]||new n(r);u.update(u.status||s,u.lists||t);o[r]=u;p[r]&&p[r].forEach(function(v){v(u);});p[r]=null;},setSpecialLists:function(r){var s=n.CLOSE_FRIENDS===null;n.CLOSE_FRIENDS=r.close+'';n.ACQUAINTANCES=r.acq+'';if(s)m(o,function(t,u){u._informListChange();});}});e.exports=n;});
__d("FriendEditLists",["Arbiter","AsyncRequest","CSS","DOMQuery","DynamicFriendListEducation","EditSubscriptions","Event","FriendStatus","MenuDeprecated","Parent","ScrollableArea","SubscribeButton","URI","$","arrayContains","copyProperties","ge"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('AsyncRequest'),i=b('CSS'),j=b('DOMQuery'),k=b('DynamicFriendListEducation'),l=b('EditSubscriptions'),m=b('Event'),n=b('FriendStatus'),o=b('MenuDeprecated'),p=b('Parent'),q=b('ScrollableArea'),r=b('SubscribeButton'),s=b('URI'),t=b('$'),u=b('arrayContains'),v=b('copyProperties'),w=b('ge'),x=5,y={},z='/ajax/profile/removefriendconfirm.php',aa='/ajax/friends/requests/cancel.php',ba='/ajax/choose/',ca='/profile.php',da='/ajax/report/social.php',ea,fa,ga,ha=null,ia={profile_browser:43,fbx_top_bar:1,hovercard:5};function ja(ua,va,wa){var xa=y[ua.id],ya=function(za){var ab={action:wa?'add_list':'del_list',to_friend:xa.id,friendlists:[va],source:ea};if(za)v(ab,za);xa.updateList(va,wa);var bb;if(wa&&va==n.CLOSE_FRIENDS){bb=ma(ua,n.ACQUAINTANCES);if(o.isItemChecked(bb)){o.toggleItem(bb);ja(ua,n.ACQUAINTANCES,false);}}else if(wa&&va==n.ACQUAINTANCES){bb=ma(ua,n.CLOSE_FRIENDS);if(o.isItemChecked(bb)){o.toggleItem(bb);ja(ua,n.CLOSE_FRIENDS,false);}}var cb={flid:va,uid:xa.id},db=wa?'FriendListHovercard/add':'FriendListHovercard/remove';g.inform(db,cb);new h().setURI('/ajax/add_friend/action.php').setData(ab).send();};if(wa){k.showDialog(va,xa.id,ya);}else ya();}function ka(ua){var va=j.scry(ua,'input')[0];return va&&va.value;}function la(ua,va,wa){var xa={uid:va.id};new h().setURI(aa).setMethod('POST').setData({friend:va.id,cancel_ref:ga}).setHandler(g.inform.bind(g,'FriendRequest/cancel',xa)).setErrorHandler(g.inform.bind(g,'FriendRequest/cancelFail',xa)).setStatusElement(wa).send();}function ma(ua,va){var wa=o.getItems(ua);for(var xa=0;xa<wa.length;xa++)if(ka(wa[xa])==va)return wa[xa];return null;}function na(ua,va){var wa=o.getItems(ua);wa.forEach(function(xa){var ya=ka(xa),za=u(va.lists,ya);if(o.isItemChecked(xa)!==za)o.toggleItem(xa);});}function oa(ua){var va=o.getItems(ua),wa=!i.hasClass(ua,'followButtonFlyout')&&!i.hasClass(ua,'likeButtonFlyout'),xa=[],ya=[],za=0,ab=0;va.forEach(function(fb){if(i.hasClass(fb,'neverHide')){i.removeClass(fb,'underShowMore');za++;}else if(o.isItemChecked(fb)){xa.push(fb);}else if(i.hasClass(fb,'neverShow')||i.hasClass(fb,'FriendListCreateTrigger')||(!wa&&i.hasClass(fb,'friendOptionsOnly'))){i.addClass(fb,'underShowMore');ab++;}else ya.push(fb);});var bb=x-za,cb=xa.concat(ya),db=ab;cb.forEach(function(fb){if(i.hasClass(fb,'ShowMoreItem')){bb--;return;}if(bb){i.removeClass(fb,'underShowMore');bb--;}else{i.addClass(fb,'underShowMore');db=true;}});i.conditionClass(ua,'hasMoreFriendListItems',db);var eb=j.scry(ua,'.FriendListMenuShowMore');eb.forEach(function(fb){i.removeClass(fb,'FriendListMenuShowMore');});}function pa(ua,va){i.conditionClass(ua,'FriendListMemorializedUser',va);}function qa(ua,va){i.conditionClass(ua,'FriendListCannotSuggestFriends',!va);}function ra(ua,va){var wa=j.scry(ua,'.FriendListUnfriend')[0],xa=j.scry(ua,'.FriendListCancel')[0],ya=j.scry(ua,'.FriendListSuggestFriends')[0],za=j.scry(ua,'.FriendListFriendship')[0],ab=j.scry(ua,'.FriendListReportBlock')[0];if(xa)i.conditionShow(xa,va.status==n.OUTGOING_REQUEST);if(wa){i.conditionShow(wa,va.status==n.ARE_FRIENDS);var bb=j.find(wa,'a');bb.setAttribute('ajaxify',s(z).addQueryData({uid:va.id,unref:fa}).toString());if(!ha)ha=m.listen(bb,'click',function(cb){var db=p.byClass(cb.getTarget(),'FriendListUnfriend');if(!db)return;var eb=s(j.find(db,'a').getAttribute('ajaxify')).getQueryData();});}else i.conditionClass(ua,'NoFriendListActionSeparator',!xa||va.status!=n.OUTGOING_REQUEST);if(ya)j.find(ya,'a').setAttribute('href',s(ba).addQueryData({type:'suggest_friends',newcomer:va.id,ref:'profile_others_dropdown'}).toString());if(za){i.conditionShow(za,va.status==n.ARE_FRIENDS);j.find(za,'a').setAttribute('href',s(ca).addQueryData({and:va.id}).toString());}if(ab)j.find(ab,'a').setAttribute('ajaxify',s(da).addQueryData({content_type:0,cid:va.id,rid:va.id}).toString());}function sa(ua,va,wa){var xa=j.scry(ua,'div.FriendListSubscriptionsMenu');if(xa.length!==0)l.init(ua,va,wa);}g.subscribe('FriendRequest/change',function(ua,va){for(var wa in y){var xa=w(wa),ya=y[wa];if(xa&&ya&&ya.id==va.uid){na(xa,ya);ra(xa,ya);oa(xa);}}});o.subscribe('select',function(ua,va){if(i.hasClass(va.item,'ShowMoreItem')&&i.hasClass(va.menu,'FriendListMenu')){i.addClass(va.menu,'FriendListMenuShowMore');q.poke(va.item);}});var ta={init:function(ua,va,wa,xa,ya,za,ab){ua=t(ua);ea=wa;fa=za;ga=ab;var bb=ia[wa]||45;if(!y[ua.id])o.subscribe('select',function(cb,db){if(j.contains(ua,db.item))if(p.byClass(db.item,'FriendListItem')){o.toggleItem(db.item);var eb=ka(db.item);ja(ua,eb,o.isItemChecked(db.item));}else if(p.byClass(db.item,'FriendListCancel')){la(ua,y[ua.id],db.item);}else if(p.byClass(db.item,'FriendListUnfriend'))g.inform('FriendEditLists/unfriend');});i.addClass(ua,'async_saving');n.getFriend(va,function(cb){pa(ua,xa);qa(ua,ya);na(ua,cb);ra(ua,cb);y[ua.id]=cb;oa(ua);sa(ua,va,bb);i.removeClass(ua,'async_saving');}.bind(this));}};e.exports=a.FriendEditLists||ta;});
__d("FriendListFlyoutController",["Event","Arbiter","AsyncRequest","Button","ContextualLayer","CSS","DataStore","Dialog","DOM","DOMQuery","FriendEditLists","FriendStatus","Keys","Layer","LayerHideOnEscape","LayerTabIsolation","MenuDeprecated","Parent","ScrollableArea","Style","TabbableElements","UserAgent","cx","emptyFunction"],function(a,b,c,d,e,f){var g=b('Event'),h=b('Arbiter'),i=b('AsyncRequest'),j=b('Button'),k=b('ContextualLayer'),l=b('CSS'),m=b('DataStore'),n=b('Dialog'),o=b('DOM'),p=b('DOMQuery'),q=b('FriendEditLists'),r=b('FriendStatus'),s=b('Keys'),t=b('Layer'),u=b('LayerHideOnEscape'),v=b('LayerTabIsolation'),w=b('MenuDeprecated'),x=b('Parent'),y=b('ScrollableArea'),z=b('Style'),aa=b('TabbableElements'),ba=b('UserAgent'),ca=b('cx'),da=b('emptyFunction'),ea,fa,ga=null,ha=null,ia,ja,ka,la,ma,na,oa=1500,pa,qa=false,ra=['uiButtonConfirm','uiButtonSpecial',"_42gz","_42g-","_4jy2","_51tl","_4jy1"],sa={init:function(vb,wb){sa.init=da;ea=vb;ea.subscribe('mouseenter',bb);ea.subscribe('mouseleave',function(){if(!qa)qb();});ea.subscribe('hide',db);ea.enableBehavior(v);ea.enableBehavior(u);pa=wb;if(ga)o.setContent(ea.getContent(),[ga,ha]);var xb=function(zb){var ac=x.byClass(zb.getTarget(),'enableFriendListFlyout');if(ac){qa=true;if(ia!==ac){fa&&sb();pb(ac);}}else if(qa)sb();},yb=function(zb){var ac=x.byClass(zb.getTarget(),'enableFriendListFlyout');if(ac)if(ia===ac){clearTimeout(la);}else{fa&&sb();pb(ac);}};g.listen(document.documentElement,{click:xb,mouseover:yb,keydown:function(event){var zb=event.getTarget();if(event.getModifiers().any)return;if(!fa||p.isNodeOfType(zb,['input','textarea']))return;var ac=g.getKeyCode(event),bc;switch(ac){case s.UP:case s.DOWN:var cc=ab();bc=ya(cc);wa(cc[bc+(ac===s.UP?-1:1)]);return false;case s.SPACE:var dc=xa(zb);if(dc){ta(dc);event.prevent();}break;default:var ec=String.fromCharCode(ac).toLowerCase(),fc=ab();bc=ya(fc);var gc=bc,hc=fc.length;while((~bc&&(gc=++gc%hc)!==bc)||(!~bc&&++gc<hc)){var ic=w.getItemLabel(fc[gc]);if(ic&&ic.charAt(0).toLowerCase()===ec){wa(fc[gc]);return false;}}}}});h.subscribe('FriendEditLists/unfriend',sb);h.subscribe('DynamicFriendListEducation/dialogOpen',function(){na=true;});h.subscribe('DynamicFriendListEducation/dialogClosed',function(){na=false;qb();});},initContent:function(vb){o.appendContent(document.body,vb);eb(vb);(function(){if(!ga){ga=vb;ea&&o.setContent(ea.getContent(),[ga,ha]);l.show(ga);g.listen(ga,'click',tb);fa&&mb(ia);}else{o.remove(vb);vb=null;}}).defer();},initNux:function(vb){if(ha)return;ha=vb;ea&&o.setContent(ea.getContent(),[ga,ha]);},show:function(vb){nb(vb);},hide:function(vb){vb===false?sb():qb();},setActiveNode:function(vb){fa&&sb();ia=vb;ja=g.listen(vb,'mouseleave',function(){ia=null;ja&&ja.remove();});},setCloseListener:function(vb,wb){m.set(vb,'flfcloselistener',wb);if(ia!=vb)m.set(vb,'flfcloselistenertimeout',ub.curry(vb).defer(oa));},setCloseListenerTimeout:function(vb){oa=vb;}};function ta(vb){ba.firefox()&&va(vb).blur();w.inform('select',{menu:ua(vb),item:vb});}function ua(vb){if(l.hasClass(vb,'uiMenuContainer'))return vb;return x.byClass(vb,'uiMenu');}function va(vb){return p.find(vb,'a.itemAnchor');}function wa(vb){if(vb&&za(vb)){w._removeSelected(ea.getContent());l.addClass(vb,'selected');va(vb).focus();}}function xa(vb){return x.byClass(vb,'uiMenuItem');}function ya(vb){if(document.activeElement){var wb=xa(document.activeElement);return vb.indexOf(wb);}return -1;}function za(vb){return !l.hasClass(vb,'disabled')&&z.get(vb,'display')!=='none'&&z.get(x.byClass(vb,'uiMenu'),'display')!=='none';}function ab(){return w.getItems(ea.getContent()).filter(za);}function bb(){clearTimeout(la);}function cb(vb){for(var wb=0;wb<ra.length;wb++)if(l.hasClass(vb,ra[wb]))return false;return true;}function db(){if(ia){if(cb(ia)){l.removeClass(ia,"_52nd");if(l.hasClass(ia,'uiButton')||l.hasClass(ia,"_42fu"))l.removeClass(ia,'selected');}if(m.get(ia,'flfcloselistener')){var vb=ia;m.set(ia,'flfcloselistenertimeout',ub.curry(vb).defer(oa));}}fa=false;lb();ia=null;}function eb(vb){var wb=p.scry(vb,'[tabindex="0"]');wb.forEach(function(xb){xb.tabIndex='-1';});wb[0]&&(wb[0].tabIndex='0');}function fb(vb){if(p.isNodeOfType(vb,'label')&&l.hasClass(vb,'uiButton'))vb=j.getInputElement(vb);return vb;}function gb(vb){return m.get(fb(vb),'profileid');}function hb(vb){return m.get(fb(vb),'memorialized')==='true';}function ib(vb){return m.get(fb(vb),'cansuggestfriends')==='true';}function jb(vb){return m.get(fb(vb),'unref');}function kb(vb){return m.get(fb(vb),'cancelref');}function lb(){ja&&ja.remove();ja=null;ma&&t.unsubscribe(ma);ma=null;la&&clearTimeout(la);la=null;}function mb(vb){var wb=gb(vb),xb=hb(vb),yb=ib(vb),zb=m.get(vb,'flloc'),ac=jb(vb),bc=kb(vb);q.init(ga,wb,zb,xb,yb,ac,bc);l.conditionClass(ga,'followButtonFlyout',l.hasClass(vb,'profileFollowButton'));l.conditionClass(ga,'friendButtonFlyout',l.hasClass(vb,'FriendRequestFriends')||l.hasClass(vb,'FriendRequestIncoming')||l.hasClass(vb,'FriendRequestOutgoing'));l.conditionClass(ga,'likeButtonFlyout',l.hasClass(vb,'profileLikeButton'));var cc=p.scry(ga,'div.uiScrollableArea')[0];cc&&y.poke(cc);var dc=aa.find(ga)[0];dc&&dc.focus();}function nb(vb){if(!ea||fa)return;ea.setContext(vb);ea.setCausalElement(vb);vb.setAttribute('aria-expanded','true');if(cb(vb)){l.addClass(vb,"_52nd");if(l.hasClass(vb,'uiButton')||l.hasClass(vb,"_42fu"))l.addClass(vb,'selected');}ea.show();ia=vb;fa=true;var wb=null;if(ga){wb='show';mb(vb);}else{wb='init_show';new i().setURI('/ajax/friends/lists/flyout_content.php').setStatusElement(ea.getContent()).send();}lb();ja=g.listen(vb,'mouseleave',qb);ma=t.subscribe('show',ob);if(m.get(vb,'flfcloselistener'))clearTimeout(m.remove(vb,'flfcloselistenertimeout'));var xb=gb(vb);r.getFriend(xb,function(yb){if(yb.status==r.ARE_FRIENDS)new i().setURI('/ajax/friends/lists/flyout_log.php').setData({target_id:gb(vb),unref:jb(vb),action:wb}).send();if(!ha)return;if(yb.status==r.OUTGOING_REQUEST){l.show(ha);i.bootstrap('/ajax/friends/lists/nux_flyout.php',null,true);}else l.hide(ha);});}function ob(vb,wb){if(!(wb instanceof k)||!p.contains(ia,wb.getContext()))qb();}function pb(vb){ia=vb;ka=nb.curry(vb).defer(pa);ja=g.listen(vb,'mouseleave',function(){clearTimeout(ka);ia=null;ja&&ja.remove();});}function qb(){la=sb.defer(150);}function rb(){var vb=n.getCurrent(),wb=vb&&vb.getBody();return !!(wb&&p.scry(wb,'.friendListDialogTourCarousel')[0]);}function sb(){if(na||rb())return;qa=false;ba.ie()<8&&document.documentElement.focus();if(ea){ea.hide();var vb=ea.getCausalElement();vb&&vb.setAttribute('aria-expanded','false');}}function tb(event){var vb=x.byTag(event.getTarget(),'a');if(vb&&l.hasClass(vb,'FriendListActionItem'))qb();}function ub(vb){var wb=m.remove(vb,'flfcloselistener');wb&&wb();}e.exports=a.FriendListFlyoutController||sa;});
__d("AddFriendButton",["Event","Animation","Arbiter","AsyncRequest","AsyncResponse","collectDataAttributes","CSS","DOMQuery","FriendListFlyoutController","FriendStatus","ge","goURI","Style","SubscribeButton","URI","XPubcontentChainedSuggestionsControllerURIBuilder"],function(a,b,c,d,e,f){var g=b('Event'),h=b('Animation'),i=b('Arbiter'),j=b('AsyncRequest'),k=b('AsyncResponse'),l=b('collectDataAttributes'),m=b('CSS'),n=b('DOMQuery'),o=b('FriendListFlyoutController'),p=b('FriendStatus'),q=b('ge'),r=b('goURI'),s=b('Style'),t=b('SubscribeButton'),u=b('URI'),v=b('XPubcontentChainedSuggestionsControllerURIBuilder'),w={ERROR_ALREADY_ADDED:1431005,init:function(x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia){var ja=x.id,ka=null,la=n.scry(x,'.addButton')[0],ma=n.scry(x,'.addFriendText')[0],na=n.scry(x,'.outgoingButton')[0],oa=n.scry(x,'.incomingButton')[0],pa=n.scry(x,'.friendButton')[0];function qa(wa,xa,ya){var za=new u(la.getAttribute('ajaxify')),ab=l(x,['ft','gt']);new j().setURI(ca).setData({to_friend:y,action:wa,how_found:aa,ref_param:ba,link_data:ab,outgoing_id:na.id,xids:za.getQueryData().xids,logging_location:da,no_flyout_on_click:ea,ego_log_data:fa,http_referer:ha}).setErrorHandler(xa).setServerDialogCancelHandler(ya).setRelativeTo(na).send();if(ia&&wa==='add_friend'){var bb=(new v()).getURI();new j().setURI(bb).send();}i.inform(t.SUBSCRIBED,{profile_id:y.toString()});}function ra(wa,xa){if(ma){m.hide(ma);}else if(la)m.hide(la);na&&m.hide(na);oa&&m.hide(oa);pa&&m.hide(pa);if(wa)m.show(wa);if('Outgoing'==xa&&ka!=xa&&ga)new h(wa).from('backgroundColor','#FFF8CC').to('backgroundColor','transparent').from('borderColor','#FFE222').to('borderColor',s.get(wa,'borderLeftColor')).duration(2000).go();ka&&m.removeClass(x,'fStatus'+ka);ka=xa;m.addClass(x,'fStatus'+xa);}function sa(wa){if(m.hasClass(wa,'enableFriendListFlyout')){o.show(wa);}else o.hide();}var ta=i.subscribe('FriendRequest/change',function(wa,xa){va();if(xa.uid!=y)return;switch(xa.status){case p.ARE_FRIENDS:return ra(pa,'Friends');case p.INCOMING_REQUEST:return ra(oa,'Incoming');case p.OUTGOING_REQUEST:return ra(na,'Outgoing');case p.CAN_REQUEST:return ra(ma?ma:la,'Requestable');}}),ua;if(z)ua=i.subscribe('FriendRequest/confirm',function(wa,xa){va();xa.uid==y&&r(z);});la&&g.listen(la,'click',function(){i.inform('FriendRequest/sending',{uid:y});if(ea){o.setActiveNode(na);}else sa(na);qa("add_friend",function(wa){var xa=wa.error==w.ERROR_ALREADY_ADDED?'FriendRequest/sent':'FriendRequest/sendFail';i.inform(xa,{uid:y});o.hide();k.defaultErrorHandler(wa);},function(wa){i.inform('FriendRequest/sendFail',{uid:y});o.hide();});});function va(){if(q(ja))return;ta&&ta.unsubscribe();ua&&ua.unsubscribe();ta=ua=null;}}};e.exports=w;});
__d("legacy:DynamicFriendListEducation",["DynamicFriendListEducation"],function(a,b,c,d){a.DynamicFriendListEducation=b('DynamicFriendListEducation');},3);
__d("FriendButtonIcon",["Arbiter","FriendStatus","Button","arrayContains"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('FriendStatus'),i=b('Button'),j=b('arrayContains');e.exports={register:function(k,l,m){g.subscribe('FriendListMembershipChange',function(n,o){if(o.uid==m){var p=j(o.lists,h.CLOSE_FRIENDS),q=j(o.lists,h.ACQUAINTANCES);if(p&&!q){i.setIcon(k,l.close);}else if(q&&!p){i.setIcon(k,l.acquaintance);}else i.setIcon(k,l.friend);}});}};});